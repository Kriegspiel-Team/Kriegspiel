all: cahier_charge.pdf architecture.pdf

%.pdf: %.tex vc.tex
	pdflatex $<

clean:
	rm -f *.pdf *.aux *.log *.bbl *.blg *.dvi *.out vc.tex

dvi: biblio.tex ref.bib
	latex biblio.tex
	bibtex biblio
	latex biblio.tex
	latex biblio.tex

pdf: dvi 
	dvipdf biblio.dvi

vc.tex: ../.git/logs/HEAD
	echo "%%% This file is generated by Makefile." > vc.tex
	echo "%%% Do not edit this file!\n%%%" >> vc.tex
	git log -1 --format="format:\
		\\gdef\\GITAbrHash{%h}\
		\\gdef\\GITAuthorDate{%ad}" >> vc.tex